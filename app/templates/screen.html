<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cat Feeder</title>
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="icon" href="/assets/tuxedo-cat.png" type="image/png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Cat Feeder">
    <link rel="stylesheet" href="/static/screen.css">
  </head>
  <body data-initial="__INITIAL_HASH__" data-mode="__MODE__">
    <div class="shell">
      <div class="appbar">
        <div class="brand">
          <img src="/assets/tuxedo-cat.png" alt="Tuxedo cat">
          <div>
            <div class="label">Cat Feeder</div>
            <div class="value">v.0.2</div>
            <div class="app-version">__APP_VERSION__</div>
          </div>
        </div>
        <div class="appbar-right">
          <div class="username" id="username-display"></div>
          <button class="logout" id="logout-btn" style="display: none;">Logout</button>
          <div class="pill" id="auth-pill">Signed out</div>
        </div>
      </div>
      <div class="page-links" id="page-links" style="display: none;">
        <a href="/screen">Dashboard</a>
        <a href="/screen/status">Status</a>
        <a href="/pets/list">Pets</a>
        <a href="/pets/new">Add Pet</a>
        <a href="/admin">Admin</a>
      </div>

      <div class="panel" id="auth-panel">
        <div class="note">Sign in or create an account to continue.</div>
        <div class="card-grid" style="margin-top: 0.75rem;">
          <div class="card">
            <div class="label">Login</div>
            <form id="login-form">
              <div>
                <label for="login_user">Username</label>
                <input id="login_user" type="text">
              </div>
              <div>
                <label for="login_pass">Password</label>
                <input id="login_pass" type="password">
              </div>
              <button class="primary" type="submit">Sign In</button>
            </form>
            <div class="status" id="login-status" style="display: none;"></div>
          </div>
          <div class="card" id="signup-card">
            <div class="label">Create Account</div>
            <form id="signup-form">
              <div>
                <label for="signup_user">Username</label>
                <input id="signup_user" type="text">
              </div>
              <div>
                <label for="signup_pass">Password</label>
                <input id="signup_pass" type="password">
              </div>
              <button class="primary" type="submit">Create</button>
            </form>
            <div class="status" id="signup-status" style="display: none;"></div>
          </div>
        </div>
      </div>

      <div class="panel hidden" id="dashboard-panel">
        <div class="label">Dashboard</div>
        <div class="note">Today at a glance.</div>
        <div class="card-grid" style="margin-top: 0.75rem;">
          <div class="card">
            <div class="label">Today Feedings</div>
            <div class="value" id="dashboard-total-feedings">-</div>
          </div>
          <div class="card">
            <div class="label">Today Grams</div>
            <div class="value" id="dashboard-total-grams">-</div>
          </div>
          <div class="card">
            <div class="label">Remaining Feedings</div>
            <div class="value" id="dashboard-remaining-feedings">-</div>
          </div>
          <div class="card">
            <div class="label">Active Pets</div>
            <div class="value" id="dashboard-pets-count">-</div>
          </div>
        </div>
        <div class="card" style="margin-top: 0.9rem;">
          <div class="label">Quick Actions</div>
          <div class="actions" style="margin-top: 0.4rem;">
            <a class="button-link" href="/pets/list">View Pets</a>
            <a class="button-link" href="/pets/new">Add Pet</a>
            <a class="button-link" href="/screen/status">View Status</a>
          </div>
        </div>
        <div class="card" style="margin-top: 0.9rem;">
          <div class="label">Alerts</div>
          <div class="note">Pets near their daily limit.</div>
          <div class="alert-list" id="dashboard-alerts"></div>
        </div>
        <div class="card" style="margin-top: 0.9rem;">
          <div class="label">Pet Snapshots</div>
          <div class="note">Last fed and remaining feedings.</div>
          <div class="pet-card-grid" id="dashboard-pet-list"></div>
        </div>
        <div class="card" style="margin-top: 0.9rem;">
          <div class="label">Recent Activity</div>
          <div class="tip-text" id="tip-text">Tip: Log feedings from each pet profile.</div>
          <div class="activity-list" id="activity-list"></div>
        </div>
      </div>

      <div class="panel hidden" id="status-panel">
        <div class="card">
          <div class="label">Filters</div>
          <div class="filters">
            <div>
              <label for="stats-start">Start Date</label>
              <input id="stats-start" type="date">
            </div>
            <div>
              <label for="stats-end">End Date</label>
              <input id="stats-end" type="date">
            </div>
            <div>
              <label for="stats-pet">Pet</label>
              <select id="stats-pet">
                <option value="">All pets</option>
              </select>
            </div>
            <div>
              <label>&nbsp;</label>
              <button id="stats-apply" type="button">Apply</button>
            </div>
          </div>
          <a class="button-link" id="stats-export" href="/stats/export">Export CSV</a>
          <div class="note" id="last-updated">Last updated: --</div>
          <div class="note hidden" id="stats-empty">No stats yet. Log a feeding to see charts.</div>
        </div>
        <div class="card-grid">
          <div class="card">
            <div class="label">Last Fed At</div>
            <div class="value" id="last-fed-at">-</div>
          </div>
          <div class="card">
            <div class="label">Last Diet Type</div>
            <div class="value" id="last-diet-type">-</div>
          </div>
          <div class="card">
            <div class="label">Daily Count</div>
            <div class="value" id="daily-count">-</div>
          </div>
          <div class="card">
            <div class="label">Remaining Feedings</div>
            <div class="value" id="remaining-feedings">-</div>
          </div>
        </div>
        <div class="ring-grid" id="ring-grid">
          <div class="ring" id="ring-summary">
            <div class="ring-content">
              <div class="ring-grams" id="ring-total">0g</div>
              <div class="ring-sub" id="ring-sub">No data</div>
            </div>
          </div>
        </div>
        <svg
          class="sparkline"
          id="sparkline"
          viewBox="0 0 100 40"
          preserveAspectRatio="none"
        ></svg>
        <div class="card" id="push-card">
          <div class="label">Phone Alerts</div>
          <div class="note">Add to Home Screen on iPhone before enabling.</div>
          <div class="actions">
            <button class="primary" type="button" id="push-enable">Enable notifications</button>
            <button class="button-link" type="button" id="push-disable">Disable</button>
          </div>
          <div class="status" id="push-status" style="display: none;"></div>
        </div>
      </div>

      <div class="panel hidden" id="pets-panel">
        <form id="pet-form">
          <div>
            <label for="pet_name">Name</label>
            <input id="pet_name" type="text" required>
          </div>
          <div>
            <label for="pet_breed">Breed</label>
            <select id="pet_breed">
              <option value="">Unknown</option>
              <option>Domestic Shorthair</option>
              <option>Domestic Longhair</option>
              <option>Maine Coon</option>
              <option>Siamese</option>
              <option>Persian</option>
              <option>Bengal</option>
              <option>British Shorthair</option>
              <option>Sphynx</option>
              <option>Ragdoll</option>
            </select>
          </div>
          <div>
            <label for="pet_age">Age (years)</label>
            <input id="pet_age" type="number" min="0">
          </div>
          <div>
            <label for="pet_sex">Sex</label>
            <input id="pet_sex" type="text">
          </div>
          <div>
            <label for="pet_weight">Estimated Weight (kg)</label>
            <input id="pet_weight" type="number" step="0.1" min="0">
          </div>
          <div>
            <label for="pet_diet">Diet Type</label>
            <input id="pet_diet" type="text">
          </div>
          <div>
            <label for="pet_photo">Photo (from phone)</label>
            <input id="pet_photo" type="file" accept="image/*">
          </div>
          <div>
            <label for="pet_vet">Last Vet Visit</label>
            <input id="pet_vet" type="date">
          </div>
          <button class="primary" type="submit">Create Pet</button>
        </form>
        <div class="card status-card hidden" id="pet-message-card">
          <div class="status" id="pet-status"></div>
          <div class="status" id="pet-created"></div>
        </div>
        <div class="card" style="margin-top: 1rem;">
          <label for="pet-search">Search pets</label>
          <input id="pet-search" type="text" placeholder="Type a name">
        </div>
        <ul class="pet-list" id="pet-list"></ul>
      </div>
    </div>
    <script src="/static/screen.js" defer></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker.register("/sw.js").catch(() => {});
        });
      }
    </script>
  </body>
</html>
